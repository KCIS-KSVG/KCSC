<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KCSC | 26SPR | 行政专员</title>
    <link rel="icon" href="https://raw.githubusercontent.com/KCIS-KSVG/Data/main/embed/kcsc-logo.png" type="image/png">
    
    <style>
        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: #f5f5f7;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        .iframe-container {
            width: 100%; height: 100vh; display: flex; flex-direction: column;
            position: relative; z-index: 1;
        }
        iframe {
            flex-grow: 1; border: none; width: 100%; height: 100%; display: block;
            -webkit-overflow-scrolling: touch; 
        }
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #ffffff; z-index: 999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.4s ease;
        }
        .loader {
            border: 5px solid #f3f3f3; border-top: 5px solid #920783;
            border-radius: 50%; width: 50px; height: 50px;
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        .loading-text { color: #424245; font-size: 14px; font-weight: 600; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .fallback-link {
            display: none; position: fixed; bottom: 20px; left: 50%;
            transform: translateX(-50%); background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-size: 12px; color: #920783; text-decoration: none; z-index: 100; border: 1px solid #eee;
        }
    </style>
</head>
<body>

    <div id="loading-overlay">
        <div class="loader"></div>
        <div class="loading-text">正在连接 KCSC 问卷系统...</div>
    </div>

    <div class="iframe-container">
        <iframe id="survey-frame" src="about:blank" title="Survey" allowfullscreen></iframe>
    </div>

    <a href="#" id="fallback-btn" class="fallback-link" target="_blank">页面无法加载？点此直接打开</a>

    <script>
        // ==========================================
        // 【在此处填入链接】
        // 只需要修改下面这一行引号里的内容即可
        // ==========================================
        
        const MY_SURVEY_LINK = "https://ks.wjx.com/vm/tg83QXd.aspx# "; 

        // ==========================================
        
        document.addEventListener("DOMContentLoaded", function() {
            const iframe = document.getElementById('survey-frame');
            const loader = document.getElementById('loading-overlay');
            const fallbackBtn = document.getElementById('fallback-btn');

            // 只要链接不是空的，就执行加载，不再报错
            if (MY_SURVEY_LINK && MY_SURVEY_LINK.length > 5) {
                iframe.src = MY_SURVEY_LINK;
                fallbackBtn.href = MY_SURVEY_LINK;
            }

            // 监听加载完成
            iframe.onload = function() {
                loader.style.opacity = '0';
                setTimeout(() => { loader.style.display = 'none'; }, 400);
            };

            // 3秒后显示备用按钮
            setTimeout(() => { fallbackBtn.style.display = 'block'; }, 3000);
        });
    </script>
</body>
</html>